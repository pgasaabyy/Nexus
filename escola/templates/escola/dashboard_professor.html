{% extends 'escola/base_professor.html' %}
{% load static %}

{% block title %}Dashboard - Professor{% endblock %}
{% block nav_dashboard %}active{% endblock %}
{% block page_title %}Dashboard{% endblock %}

{% block extra_css %}
<style>
    .dashboard-section { max-width: 1200px; }
    .stats-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: white; border-radius: 12px; padding: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.08); border: 1px solid #e0e0e0; }
    .stat-info .stat-value { font-size: 28px; font-weight: 600; color: #003366; display: block; }
    .stat-info .stat-label { font-size: 14px; color: #666; }
    .stat-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; }
    .stat-icon.blue { background: #003366; }
    .stat-icon.green { background: #28a745; }
    .stat-icon.orange { background: #fd7e14; }
    .content-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 24px; margin-bottom: 30px; }
    .content-card { background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); overflow: hidden; }
    .card-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; background: #f8f8f8; border-bottom: 1px solid #e0e0e0; }
    .card-header h3 { font-size: 16px; font-weight: 600; color: #333; margin: 0; }
    .card-body { padding: 20px; }
    .data-table { width: 100%; border-collapse: collapse; }
    .data-table th, .data-table td { padding: 10px; text-align: left; border-bottom: 1px solid #f0f0f0; }
    .data-table th { font-weight: 600; color: #666; font-size: 13px; }
    .avisos-list .aviso-item { padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
    .aviso-item:last-child { border-bottom: none; }
    .aviso-title { font-weight: 500; color: #333; }
    .aviso-date { font-size: 12px; color: #666; }
    .link-more { color: #003366; text-decoration: none; font-size: 14px; }
    .empty-message { color: #666; text-align: center; padding: 20px; }
    .quick-actions { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .quick-actions h3 { font-size: 18px; font-weight: 600; color: #333; margin-bottom: 16px; }
    .action-buttons { display: flex; gap: 16px; flex-wrap: wrap; }
    .action-btn { display: flex; align-items: center; gap: 8px; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 500; transition: all 0.2s; }
    .action-btn.primary { background: #003366; color: white; }
    .action-btn.primary:hover { background: #002244; }
    .action-btn.secondary { background: #e3f2fd; color: #003366; }
    .action-btn.secondary:hover { background: #bbdefb; }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-section">
    <div class="stats-row">
        <div class="stat-card">
            <div class="stat-info">
                <span class="stat-value">{% if turmas %}{{ turmas|length }}{% else %}0{% endif %}</span>
                <span class="stat-label">Turmas Ativas</span>
            </div>
            <div class="stat-icon blue">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                    <line x1="8" y1="21" x2="16" y2="21"></line>
                    <line x1="12" y1="17" x2="12" y2="21"></line>
                </svg>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-info">
                <span class="stat-value">{{ total_alunos|default:0 }}</span>
                <span class="stat-label">Total de Alunos</span>
            </div>
            <div class="stat-icon green">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-info">
                <span class="stat-value">{% now "d/m" %}</span>
                <span class="stat-label">Data Atual</span>
            </div>
            <div class="stat-icon orange">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
            </div>
        </div>
    </div>
    
    <div class="content-grid">
        <div class="content-card">
            <div class="card-header">
                <h3>Minhas Turmas</h3>
                <a href="{% url 'professor_notas' %}" class="link-more">Lançar Notas</a>
            </div>
            <div class="card-body">
                {% if turmas %}
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Turma</th>
                            <th>Alunos</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for turma in turmas %}
                        <tr>
                            <td>{{ turma.codigo }}</td>
                            <td>{{ turma.total_alunos }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p class="empty-message">Nenhuma turma associada.</p>
                {% endif %}
            </div>
        </div>
        
        <div class="content-card">
            <div class="card-header">
                <h3>Avisos Recentes</h3>
                <a href="{% url 'professor_comunicados' %}" class="link-more">Ver todos</a>
            </div>
            <div class="card-body">
                {% if avisos %}
                <div class="avisos-list">
                    {% for aviso in avisos %}
                    <div class="aviso-item">
                        <div class="aviso-title">{{ aviso.titulo }}</div>
                        <div class="aviso-date">{{ aviso.data_criacao|date:"d/m/Y" }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <p class="empty-message">Nenhum aviso recente.</p>
                {% endif %}
            </div>
        </div>
    </div>
    
    <div class="quick-actions">
        <h3>Ações Rápidas</h3>
        <div class="action-buttons">
            <a href="{% url 'professor_notas' %}" class="action-btn primary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                Lançar Notas
            </a>
            <a href="{% url 'professor_frequencia' %}" class="action-btn secondary">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                </svg>
                Registrar Frequência
            </a>
        </div>
    </div>
</div>
{% endblock %}
